#!/bin/bash

#
# Script to run env.Dockerfile, building an image containing the full set
# of Conda and Pip dependencies. This script should be run once, then bin/run-dev
# can be run multiple times, taking much less time than running bin/build-test
# and bin/run-test for each edit.
#

image="sds/swot-reproject-env"
tag=${1:-latest}


# Look for old version of image and remove
#
old=$(docker images | grep "$image" | grep "$tag" | awk '{print $3}')
if [ ! -z "$old" ]; then
    docker rmi "$old"
fi

# Build the image
#
docker build -t ${image}:${tag} --file bin/env-Dockerfile .
